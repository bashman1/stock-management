import{i as M,j as O,r as h,s as P,o as R,b,c as w,d as C,f as e,h as a,k as i,t as d,e as v,g as N,v as E,l as _,C as Q}from"./index-38ec273a.js";const U={class:"grid p-fluid"},$={class:"col-12 md:col-7"},j={class:"card"},z=e("h5",null,"Point Of Sale",-1),L=e("br",null,null,-1),F={class:"grid"},H={class:"col-12 md:col-12"},K=e("p",null,"Items available in the stock.",-1),G={class:"flex flex-column md:flex-row md:justify-content-between md:align-items-center"},J={class:"block mt-2 md:mt-0 p-input-icon-left"},W=e("i",{class:"pi pi-search"},null,-1),X={class:"col-12 md:col-5"},Y={class:"card"},Z=e("h5",null,"Selected Items",-1),ee=e("br",null,null,-1),te={class:"grid"},le={class:"field col-12 md:col-12"},se=["onClick"],oe=["onClick"],ae={class:"card"},ne=e("h5",null,"Total ",-1),ie=e("br",null,null,-1),ce={class:"grid"},de=e("div",{class:"field col-12 md:col-4"},[e("span",{class:"p-float-label"}," Amount To Pay ")],-1),ue={class:"field col-12 md:col-8"},re={class:"p-float-label"},me=e("div",{class:"field col-12 md:col-4"},[e("span",{class:"p-float-label"}," Discount ")],-1),_e={class:"field col-12 md:col-8"},he={class:"p-float-label"},pe=e("label",{for:"discount"},"Discount Amount",-1),ve=e("div",{class:"field col-12 md:col-4"},[e("span",{class:"p-float-label"}," Amount Paid ")],-1),fe={class:"field col-12 md:col-8"},ye={class:"p-float-label"},be=e("label",{for:"discount"},"Amount",-1),ge=e("div",{class:"field col-12 md:col-4"},[e("span",{class:"p-float-label"}," Change ")],-1),xe={class:"field col-12 md:col-8"},we={key:0,class:"p-float-label"},Ce={key:1,class:"p-float-label"},Se=e("div",{class:"field col-12 md:col-8"},null,-1),ke={class:"field col-12 md:col-4"},Ve={__name:"PointOfSale",setup(qe){const g=M(),u=new Q;O();const S=h(null),o=h([]),r=h(0),m=h(0);h(0);const f=h({}),V=()=>{u.genericRequest("get-products","get",!0,{}).then(n=>{n.status?S.value=n.data:u.showError(g,n.message)})},D=n=>{let l={id:n.id,price:n.selling_price,quantity:1,discount:0,name:n.name};const s=o.value.find(c=>c.id===l.id);s?s.quantity+=l.quantity:o.value.push(l)},I=n=>{const l=o.value.findIndex(s=>s.id===n.id);l!==-1&&o.value.splice(l,1)},T=(n,l)=>{o.value=o.value.map(s=>s.id===l.id?{...s,quantity:Number(n.target.value)}:s)},k=(n,l)=>{o.value=o.value.map(s=>{if(s.id===n.id){if(l=="Add")return{...s,quantity:Number(s.quantity+1)};if(s.quantity>0)return{...s,quantity:Number(s.quantity-1)}}return s})},y=n=>{let l=0;return n.length>0&&n.forEach(s=>{l+=s.quantity*s.price}),l},A=()=>{let n={total:y(o==null?void 0:o.value)-Number(m==null?void 0:m.value),discount:Number(m==null?void 0:m.value),amountPaid:Number(r==null?void 0:r.value),itemCount:o==null?void 0:o.value.length,tranDate:new Date,items:o==null?void 0:o.value,status:"Active"};u.genericRequest("create-order","post",!0,n).then(l=>{l.status?u.showSuccess(g,l.message):u.showError(g,l.message)})},B=()=>{f.value={global:{value:null,matchMode:E.CONTAINS}}};return P(()=>{B()}),R(()=>{V()}),(n,l)=>{const s=b("InputText"),c=b("Column"),x=b("Button"),q=b("DataTable");return w(),C("div",U,[e("div",$,[e("div",j,[z,L,e("div",F,[e("div",H,[K,a(q,{value:S.value,paginator:!0,class:"p-datatable-gridlines",rows:50,dataKey:"id",filters:f.value,rowHover:!0,filterDisplay:"menu",responsiveLayout:"scroll"},{header:i(()=>[e("div",G,[e("span",J,[W,a(s,{modelValue:f.value.global.value,"onUpdate:modelValue":l[0]||(l[0]=t=>f.value.global.value=t),placeholder:"Search..."},null,8,["modelValue"])])])]),default:i(()=>[a(c,{field:"name",header:"Product",style:{"min-width":"10rem"}},{body:i(({data:t})=>[_(d(t.name),1)]),_:1}),a(c,{field:"name",header:"Category",style:{"min-width":"10rem"}},{body:i(({data:t})=>[_(d(t.category_name),1)]),_:1}),a(c,{field:"name",header:"Price",style:{"max-width":"10rem"}},{body:i(({data:t})=>[_(d(v(u).commaSeparator(t.selling_price)),1)]),_:1}),a(c,{field:"name",header:"Quantity",style:{"max-width":"15rem"}},{body:i(({data:t})=>[_(d(t.quantity+" "+t.unit),1)]),_:1}),a(c,{header:"Manufacturer",style:{"min-width":"10rem"}},{body:i(({data:t})=>[_(d(t.manufacturer),1)]),_:1}),a(c,{header:"Date",style:{"min-width":"10rem"}},{body:i(({data:t})=>[_(d(t.created_at),1)]),_:1}),a(c,{headerStyle:"max-width:10rem;"},{body:i(({data:t})=>[a(x,{icon:"pi pi-check",class:"p-button-rounded p-button-success mr-2",onClick:p=>D(t)},null,8,["onClick"])]),_:1})]),_:1},8,["value","filters"])])])])]),e("div",X,[e("div",Y,[Z,ee,e("div",te,[e("div",le,[a(q,{value:o.value,size:"small",rows:20,dataKey:"id",rowHover:!0,filterDisplay:"menu",responsiveLayout:"scroll"},{default:i(()=>[a(c,{field:"name",header:"Name",style:{"max-width":"10rem"}},{body:i(({data:t})=>[_(d(t.name),1)]),_:1}),a(c,{field:"price",header:"Price",style:{"max-width":"10rem"}},{body:i(({data:t})=>[_(d(v(u).commaSeparator(t.price)),1)]),_:1}),a(c,{field:"quantity",header:"Qty",style:{"min-width":"10rem"}},{body:i(({data:t})=>[e("i",{class:"pi pi-plus",onClick:p=>k(t,"Add"),style:{"font-size":"1rem","margin-right":"3px",cursor:"pointer"}},null,8,se),a(s,{type:"text",onChange:p=>T(p,t),value:t.quantity,style:{width:"60px",padding:"5px","margin-left":"1px","margin-right":"1px","text-align":"center"},placeholder:"Qty"},null,8,["onChange","value"]),e("i",{class:"pi pi-minus",onClick:p=>k(t,"Subtract"),style:{"font-size":"1rem","margin-left":"3px",cursor:"pointer"}},null,8,oe)]),_:1}),a(c,{field:"subtotal",header:"Sub Total",style:{"max-width":"10rem"}},{body:i(({data:t})=>[_(d(v(u).commaSeparator(t.quantity*t.price)),1)]),_:1}),a(c,{headerStyle:"max-width:10rem;"},{body:i(({data:t})=>[a(x,{icon:"pi pi-trash",class:"p-button-rounded p-button-danger mr-2",onClick:p=>I(t)},null,8,["onClick"])]),_:1})]),_:1},8,["value"])])])]),e("div",ae,[ne,ie,e("div",ce,[de,e("div",ue,[e("span",re,d(y(o.value)?v(u).commaSeparator(y(o.value)-Number(m.value)):0),1)]),me,e("div",_e,[e("span",he,[a(s,{type:"text",id:"discount",modelValue:m.value,"onUpdate:modelValue":l[1]||(l[1]=t=>m.value=t)},null,8,["modelValue"]),pe])]),ve,e("div",fe,[e("span",ye,[a(s,{type:"text",id:"discount",modelValue:r.value,"onUpdate:modelValue":l[2]||(l[2]=t=>r.value=t)},null,8,["modelValue"]),be])]),ge,e("div",xe,[r.value&&r.value>0?(w(),C("span",we,d(v(u).commaSeparator(Number(r.value)+Number(m.value)-y(o.value))),1)):N("",!0),!r.value||r.value==0?(w(),C("span",Ce,"0")):N("",!0)]),Se,e("div",ke,[a(x,{onClick:A,label:"SUBMIT",class:"p-button-outlined mr-2 mb-2"})])])])])])}}};export{Ve as default};
