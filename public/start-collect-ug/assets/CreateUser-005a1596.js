import{k as _l,m as wl,l as yl,r as a,o as gl,b as C,c as F,d as I,e,h as u,n as A,g as O,C as Ul}from"./index-9434943a.js";const xl={class:"card"},Bl={class:"grid p-fluid mt-3"},Cl={class:"field col-12 md:col-4"},Fl={class:"p-float-label"},Il={class:"field col-12 md:col-4"},Al={class:"p-float-label"},Nl={class:"field col-12 md:col-4"},Dl={class:"p-float-label"},Pl={class:"field col-12 md:col-4"},Rl={class:"p-float-label"},Tl={class:"field col-12 md:col-4"},kl={class:"p-float-label"},Sl={class:"field col-12 md:col-4"},ql={class:"p-float-label"},El={class:"field col-12 md:col-4"},Ll={class:"p-float-label"},Ol={class:"field col-12 md:col-4"},$l={class:"p-float-label"},Ml={key:0,class:"field col-12 md:col-4"},zl={class:"p-float-label"},Gl={key:1,class:"field col-12 md:col-4"},jl={class:"p-float-label"},Hl={key:2,class:"field col-12 md:col-4"},Jl={class:"p-float-label"},Kl={class:"field col-12 md:col-4"},Ql={class:"p-float-label"},Wl={class:"field col-12 md:col-12"},Xl={class:"p-float-label"},Yl={class:"field col-12 md:col-4"},Zl={class:"p-float-label"},hl={class:"field col-12 md:col-4"},le={class:"p-float-label"},ee={class:"field col-12 md:col-4"},te={class:"p-float-label"},ae={class:"field col-12 md:col-12"},oe={class:"p-float-label"},se={class:"card"},ne={key:0},ue={class:"grid p-fluid mt-3"},ie={key:0,class:"field col-12 md:col-6"},de={class:"p-float-label"},ve={key:1,class:"field col-12 md:col-6"},re={class:"p-float-label"},me={class:"field col-12 md:col-4"},ce={__name:"CreateUser",setup(pe){const G=_l(),i=new Ul,j=wl(),dl=yl(),b=a(null),V=a(null),N=a(null),_=a(null),D=a(null),P=a(null),R=a(null),T=a(null),z=a(null),k=a(null),S=a(null),q=a(null),y=a(null),g=a(null),H=a(null),f=a(null),U=a(null),$=a(null),M=a(null),J=a(null),x=a(null),E=a(null),L=a(null),v=a({}),s=a(null),w=a(!1),K=a([{label:"Male",value:"Male"},{label:"Female",value:"Female"}]),Q=a([{label:"Super Admin",value:"Admin"},{label:"Institution Admin",value:"Institution"}]),W=a([{label:"Branch Admin",value:"BranchAdmin"},{label:"Institution Admin",value:"InstitutionAdmin"}]),vl=()=>{var d,n,r,m;if(v.value.fName=i.validateFormField(b.value),v.value.lName=i.validateFormField(V.value),v.value.email=i.validateFormField(_.value),v.value.type=i.validateFormField(f.value),v.value.role=i.validateFormField(x.value),w.value||(v.value.password=i.validateFormField(y.value),v.value.confirmPassword=i.validateFormField(g.value)),i.validateRequiredFields(v.value)){i.showError(G,"Please fill in the missing field");return}let l={id:j.params.id,first_name:b==null?void 0:b.value,last_name:V==null?void 0:V.value,other_name:N==null?void 0:N.value,email:_==null?void 0:_.value,phone_number:D==null?void 0:D.value,date_of_birth:P==null?void 0:P.value,gender:(d=R==null?void 0:R.value)==null?void 0:d.value,address:T==null?void 0:T.value,city_id:(n=z.value)==null?void 0:n.id,street:k==null?void 0:k.value,p_o_box:S==null?void 0:S.value,description:q==null?void 0:q.value,password:y==null?void 0:y.value,confirm_password:g==null?void 0:g.value,status:"Active",user_type:(r=f==null?void 0:f.value)==null?void 0:r.value,user_category:L.value!=null?L.value.value:null,institution_id:U.value!=null?U==null?void 0:U.value.id:null,role_id:(m=x.value)==null?void 0:m.id,branch_id:$.value!=null?$.value.id:null};i.genericRequest("create-user","post",!0,l).then(c=>{c.status?(i.showSuccess(G,c.message),i.redirect(dl,"/view-users")):i.showError(G,c.message)})},rl=()=>{i.genericRequest("get-city-county-id/1","get",!0,{}).then(o=>{o.status&&(H.value=o.data)})},X=o=>{let l={institutionId:o,status:"Active"};i.genericRequest("get-institution-branches","post",!0,l).then(d=>{var n;d.status&&(J.value=d.data,w&&s.value.branch_id!=null&&($.value=(n=J.value)==null?void 0:n.find(r=>r.id==s.value.branch_id)))})},Y=o=>{let l={institutionId:o,status:"Active"};i.genericRequest("get-institution-roles","post",!0,l).then(d=>{var n;d.status&&(E.value=d.data,w&&s.value.role_id!=null&&(x.value=(n=E.value)==null?void 0:n.find(r=>r.id==s.value.role_id)))})},Z=o=>{let l={roleType:o,status:"Active"};i.genericRequest("get-role-type","post",!0,l).then(d=>{var n;d.status&&(E.value=d.data,w&&(x.value=(n=E.value)==null?void 0:n.find(r=>r.id==s.value.role_id)))})},ml=()=>{i.genericRequest("get-institutions","get",!0,{}).then(o=>{o.status&&(M.value=o.data)})},pl=o=>{X(o.value.id),Y(o.value.id)},B=(o,l)=>{v.value[l]=i.validateFormField(o)},fl=o=>{o.value.value=="Admin"?(Z(o.value.value),L.value="SuperAdmin"):E.value=[]},cl=async o=>{let l={userId:o};i.genericRequest("get-user-details","post",!0,l).then(d=>{d.status&&(s.value=d.data[0],bl())})},bl=async()=>{var o,l,d,n,r,m,c;((o=s.value)==null?void 0:o.institution_id)!=null&&(await X((l=s.value)==null?void 0:l.institution_id),await Y((d=s.value)==null?void 0:d.institution_id)),s.value.user_type=="Admin"&&await Z("Admin"),b.value=await s.value.first_name,V.value=await s.value.last_name,N.value=await s.value.other_name,_.value=await s.value.email,D.value=await s.value.phone_number,P.value=await s.value.date_of_birth,R.value=await((n=K.value)==null?void 0:n.find(p=>p.value==s.value.gender)),f.value=await((r=Q.value)==null?void 0:r.find(p=>p.value==s.value.user_type)),U.value=await(M==null?void 0:M.value.find(p=>p.id==s.value.institution_id)),L.value=await((m=W.value)==null?void 0:m.find(p=>p.value==s.value.user_category)),T.value=await s.value.address,z.value=await((c=H.value)==null?void 0:c.find(p=>p.id==s.value.city_id)),k.value=await s.value.street,S.value=await s.value.p_o_box,q.value=await s.value.description};return gl(()=>{ml(),rl(),j.params.id!=null&&(w.value=!0,cl(j.params.id))}),(o,l)=>{var h,ll,el,tl,al,ol,sl,nl,ul,il;const d=C("Toast"),n=C("InputText"),r=C("Calendar"),m=C("Dropdown"),c=C("Textarea"),p=C("Password"),Vl=C("Button");return F(),I("div",null,[e("div",xl,[l[43]||(l[43]=e("h5",null,"Create User",-1)),e("div",Bl,[u(d),e("div",Cl,[e("span",Fl,[u(n,{type:"text",id:"firstName",modelValue:b.value,"onUpdate:modelValue":l[0]||(l[0]=t=>b.value=t),onBlur:l[1]||(l[1]=t=>B(b.value,"fName")),class:A({"p-invalid":(h=v.value)==null?void 0:h.fName})},null,8,["modelValue","class"]),l[26]||(l[26]=e("label",{for:"firstName"},"First Name",-1))])]),e("div",Il,[e("span",Al,[u(n,{type:"text",id:"lastName",modelValue:V.value,"onUpdate:modelValue":l[2]||(l[2]=t=>V.value=t),onBlur:l[3]||(l[3]=t=>B(V.value,"lName")),class:A({"p-invalid":(ll=v.value)==null?void 0:ll.lName})},null,8,["modelValue","class"]),l[27]||(l[27]=e("label",{for:"lastName"},"Last Name",-1))])]),e("div",Nl,[e("span",Dl,[u(n,{type:"text",id:"otherName",modelValue:N.value,"onUpdate:modelValue":l[4]||(l[4]=t=>N.value=t)},null,8,["modelValue"]),l[28]||(l[28]=e("label",{for:"otherName"},"Other Names",-1))])]),e("div",Pl,[e("span",Rl,[u(n,{type:"text",id:"email",modelValue:_.value,"onUpdate:modelValue":l[5]||(l[5]=t=>_.value=t),onBlur:l[6]||(l[6]=t=>B(_.value,"email")),class:A({"p-invalid":(el=v.value)==null?void 0:el.email})},null,8,["modelValue","class"]),l[29]||(l[29]=e("label",{for:"email"},"Email",-1))])]),e("div",Tl,[e("span",kl,[u(n,{type:"text",id:"phoneNumber",modelValue:D.value,"onUpdate:modelValue":l[7]||(l[7]=t=>D.value=t)},null,8,["modelValue"]),l[30]||(l[30]=e("label",{for:"phoneNumber"},"Phone Number",-1))])]),e("div",Sl,[e("span",ql,[u(r,{inputId:"dob",modelValue:P.value,"onUpdate:modelValue":l[8]||(l[8]=t=>P.value=t)},null,8,["modelValue"]),l[31]||(l[31]=e("label",{for:"dob"},"Date Of Birth",-1))])]),e("div",El,[e("span",Ll,[u(m,{id:"gender",options:K.value,modelValue:R.value,"onUpdate:modelValue":l[9]||(l[9]=t=>R.value=t),optionLabel:"label"},null,8,["options","modelValue"]),l[32]||(l[32]=e("label",{for:"gender"},"Gender",-1))])]),e("div",Ol,[e("span",$l,[u(m,{id:"type",onChange:fl,options:Q.value,modelValue:f.value,"onUpdate:modelValue":l[10]||(l[10]=t=>f.value=t),optionLabel:"label",onBlur:l[11]||(l[11]=t=>B(f.value,"type")),class:A({"p-invalid":(tl=v.value)==null?void 0:tl.type})},null,8,["options","modelValue","class"]),l[33]||(l[33]=e("label",{for:"type"},"Type",-1))])]),((al=f.value)==null?void 0:al.value)=="Institution"?(F(),I("div",Ml,[e("span",zl,[u(m,{id:"institution",onChange:pl,options:M.value,modelValue:U.value,"onUpdate:modelValue":l[12]||(l[12]=t=>U.value=t),optionLabel:"name"},null,8,["options","modelValue"]),l[34]||(l[34]=e("label",{for:"institution"},"Institution",-1))])])):O("",!0),((ol=f.value)==null?void 0:ol.value)=="Institution"?(F(),I("div",Gl,[e("span",jl,[u(m,{id:"institution",options:J.value,modelValue:$.value,"onUpdate:modelValue":l[13]||(l[13]=t=>$.value=t),optionLabel:"name"},null,8,["options","modelValue"]),l[35]||(l[35]=e("label",{for:"institution"},"Branch",-1))])])):O("",!0),((sl=f.value)==null?void 0:sl.value)=="Institution"?(F(),I("div",Hl,[e("span",Jl,[u(m,{id:"institution",options:W.value,modelValue:L.value,"onUpdate:modelValue":l[14]||(l[14]=t=>L.value=t),optionLabel:"label"},null,8,["options","modelValue"]),l[36]||(l[36]=e("label",{for:"institution"},"User Category",-1))])])):O("",!0),e("div",Kl,[e("span",Ql,[u(m,{id:"institution",options:E.value,modelValue:x.value,"onUpdate:modelValue":l[15]||(l[15]=t=>x.value=t),optionLabel:"name",onBlur:l[16]||(l[16]=t=>B(x.value,"role")),class:A({"p-invalid":(nl=v.value)==null?void 0:nl.role})},null,8,["options","modelValue","class"]),l[37]||(l[37]=e("label",{for:"institution"},"Role",-1))])]),e("div",Wl,[e("span",Xl,[u(c,{inputId:"textarea",rows:"3",cols:"30",modelValue:T.value,"onUpdate:modelValue":l[17]||(l[17]=t=>T.value=t)},null,8,["modelValue"]),l[38]||(l[38]=e("label",{for:"textarea"},"Address",-1))])]),e("div",Yl,[e("span",Zl,[u(m,{id:"instCity",options:H.value,modelValue:z.value,"onUpdate:modelValue":l[18]||(l[18]=t=>z.value=t),optionLabel:"name"},null,8,["options","modelValue"]),l[39]||(l[39]=e("label",{for:"instCity"},"City",-1))])]),e("div",hl,[e("span",le,[u(n,{type:"text",id:"instStreet",modelValue:k.value,"onUpdate:modelValue":l[19]||(l[19]=t=>k.value=t)},null,8,["modelValue"]),l[40]||(l[40]=e("label",{for:"instStreet"},"Street",-1))])]),e("div",ee,[e("span",te,[u(n,{type:"text",id:"instPOBox",modelValue:S.value,"onUpdate:modelValue":l[20]||(l[20]=t=>S.value=t)},null,8,["modelValue"]),l[41]||(l[41]=e("label",{for:"instPOBox"},"P.O Box",-1))])]),e("div",ae,[e("span",oe,[u(c,{inputId:"instDescription",rows:"3",cols:"30",modelValue:q.value,"onUpdate:modelValue":l[21]||(l[21]=t=>q.value=t)},null,8,["modelValue"]),l[42]||(l[42]=e("label",{for:"instDescription"},"More Info",-1))])])])]),e("div",se,[w.value?O("",!0):(F(),I("h5",ne,"Create Password")),e("div",ue,[w.value?O("",!0):(F(),I("div",ie,[e("span",de,[u(p,{type:"text",id:"password",modelValue:y.value,"onUpdate:modelValue":l[22]||(l[22]=t=>y.value=t),onBlur:l[23]||(l[23]=t=>B(y.value,"password")),class:A({"p-invalid":(ul=v.value)==null?void 0:ul.password})},null,8,["modelValue","class"]),l[44]||(l[44]=e("label",{for:"password"},"Password",-1))])])),w.value?O("",!0):(F(),I("div",ve,[e("span",re,[u(p,{type:"text",id:"confirmPassword",modelValue:g.value,"onUpdate:modelValue":l[24]||(l[24]=t=>g.value=t),onBlur:l[25]||(l[25]=t=>B(g.value,"confirmPassword")),class:A({"p-invalid":(il=v.value)==null?void 0:il.confirmPassword})},null,8,["modelValue","class"]),l[45]||(l[45]=e("label",{for:"confirmPassword"},"Confirm Password",-1))])])),l[46]||(l[46]=e("div",{class:"field col-12 md:col-8"},null,-1)),e("div",me,[u(Vl,{onClick:vl,label:"SUBMIT",class:"p-button-outlined mr-2 mb-2"})])])])])}}};export{ce as default};
