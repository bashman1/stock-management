import{k as Z,l as ee,r as s,x as te,o as le,b as g,c as _,d as S,e as t,h as u,t as b,f as q,i as y,g as x,y as oe,v as N,j as T,C as ne}from"./index-739f16a6.js";const ae={class:"grid p-fluid"},se={class:"field col-12 md:col-3"},ie={class:"p-inputgroup"},ue={class:"p-float-label"},de=t("label",{for:"paymentMethod"},"Payment methods",-1),ce={class:"field col-12 md:col-3"},re={class:"p-inputgroup"},me={class:"p-float-label"},pe=t("label",{for:"Customer"},"Select customer",-1),ve={class:"field col-12 md:col-3"},_e={class:"p-float-label"},fe=t("label",{for:"productId"},"Billing address",-1),he={class:"field col-12 md:col-3"},ge={class:"p-float-label"},be=t("label",{for:"date"},"Sales Date",-1),ye=t("div",{class:"col-12 md:col-3"},null,-1),xe=t("div",{class:"col-12 md:col-3"},null,-1),Ce=t("div",{class:"col-12 md:col-3"},null,-1),qe={class:"col-12 md:col-3"},ke={class:"font-bold text-right text-6xl green-color"},Ie={class:"col-12 md:col-12"},Se={class:"card"},Ne=["onClick"],Te=["onClick"],Ve=t("div",{class:"col-12 md:col-1"},null,-1),we={class:"col-12 md:col-1"},De=t("div",{class:"col-12 md:col-4"},null,-1),Ue=t("div",{class:"col-12 md:col-3"},null,-1),Ee={class:"col-12 md:col-3"},Ae={class:"font-bold text-right text-xl green-color"},Be=t("div",{class:"col-12 md:col-3"},null,-1),Me={class:"col-12 md:col-3"},Le={class:"p-float-label"},Re=t("label",{for:"productId"},"Amount",-1),Oe={class:"col-12 md:col-3"},Xe={key:0,class:"font-bold text-left text-xl green-color"},$e={class:"col-12 md:col-3"},Qe={__name:"PointOfSale",setup(ze){const k=Z(),i=new ne,O=ee(),V=s(null),n=s([{id:null,price:null,quantity:null,discount:null,name:"",tax_config:null}]),v=s(0),m=s(0);s(0);const X=s({}),I=s({}),C=s(0),w=s(0),D=s(0),U=s([{id:1,name:"18%",amount:0,total:0},{id:2,name:"Exempted",amount:0,total:0}]),$=()=>{i.genericRequest("get-products","get",!0,{}).then(l=>{l.status?V.value=l.data:i.showError(k,l.message)})},z=l=>{var d;console.log(JSON.stringify(l));let e={id:l.id,price:l.selling_price,quantity:1,discount:0,name:l.name,tax_config:l.tax_config};const a=n.value.find(c=>c.id===e.id);if(a)a.quantity+=e.quantity;else{let c=n.value.length-1;n.value.splice(c,0,e)}(d=I==null?void 0:I.value)!=null&&d.is_tax_enabled&&A()},P=l=>{const e=n.value.findIndex(a=>a.id===l.id);e!==-1&&n.value.splice(e,1)},Q=(l,e)=>{n.value=n.value.map(a=>a.id===e.id?{...a,quantity:Number(l.target.value)}:a)},E=(l,e)=>{n.value=n.value.map(a=>{if(a.id===l.id){if(e=="Add")return{...a,quantity:Number(a.quantity+1)};if(a.quantity>0)return{...a,quantity:Number(a.quantity-1)}}return a}),A()},f=l=>{let e=0;return l.length>0&&l.forEach(a=>{e+=a.quantity*a.price}),e},G=()=>{n.value=n==null?void 0:n.value.filter(e=>e.id!=null);let l={total:f(n==null?void 0:n.value)-Number(m==null?void 0:m.value)+Number(C.value),discount:Number(m==null?void 0:m.value),amountPaid:Number(v==null?void 0:v.value),itemCount:n==null?void 0:n.value.length,tranDate:new Date,items:n==null?void 0:n.value,status:"Active",vat:Number(C.value),vatInc:w.value,vatEx:D.value};i.genericRequest("create-order","post",!0,l).then(e=>{e.status?(i.showSuccess(k,e.message),i.redirect(O,"/view-sales")):i.showError(k,e.message)})},j=()=>{i.genericRequest("get-institution-details","get",!0,{}).then(l=>{l.status?I.value=l.data:i.showError(k,l.message)})},F=()=>{X.value={global:{value:null,matchMode:oe.CONTAINS}}},A=()=>{let l=0,e=0,a=0;n.value.forEach(r=>{const p=r.quantity*r.price;switch(r.tax_config){case"TAX_EXCLUSIVE":l+=p;break;case"TAX_INCLUSIVE":e+=p;break;case"TAX_EXEMPTED":a+=p;break}});const d=.18*l,c=.18*e;D.value=d,w.value=c,C.value=d,U.value=U.value.map(r=>r.id===1?{...r,total:d+c,amount:l+(e-c)}:r.id===2?{...r,total:0,amount:a}:r)},H=s([]),B=s({id:1,name:"Cash"}),M=s(null),L=s(null),R=s(null);s(0),s(0);const J=s([{id:1,name:"Cash"},{id:2,name:"Bank"},{id:3,name:"Credit"}]),K=()=>[{id:null,name:"",description:"",quantity:null,rate:null,amount:null,uuid:i.generateUUID()},{id:null,name:"",description:"",quantity:null,rate:null,amount:null,uuid:i.generateUUID()},{id:null,name:"",description:"",quantity:null,rate:null,amount:null,uuid:i.generateUUID()},{id:null,name:"",description:"",quantity:null,rate:null,amount:null,uuid:i.generateUUID()},{id:null,name:"",description:"",quantity:null,rate:null,amount:null,uuid:i.generateUUID()}];s([{field:"name",header:"Product/Services"},{field:"description",header:"Description"},{field:"quantity",header:"Quantity"},{field:"rate",header:"Rate"},{field:"amount",header:"Amount"},{field:"tax",header:"Tax"}]);const W=()=>{n.value=[{id:null,price:null,quantity:null,discount:null,name:"",tax_config:null}]};return te(()=>{F()}),le(()=>{$(),j(),H.value=K()}),(l,e)=>{const a=g("Dropdown"),d=g("Button"),c=g("InputText"),r=g("Calendar"),p=g("Column"),Y=g("DataTable");return _(),S("div",ae,[t("div",se,[t("div",ie,[t("span",ue,[u(a,{id:"gauge",options:J.value,filter:"",modelValue:B.value,"onUpdate:modelValue":e[0]||(e[0]=o=>B.value=o),optionLabel:"name"},null,8,["options","modelValue"]),de]),u(d,{onClick:e[1]||(e[1]=o=>l.toggleGaugeModal(!0)),icon:"pi pi-plus"})])]),t("div",ce,[t("div",re,[t("span",me,[u(a,{id:"gauge",options:l.productGaugeList,filter:"",modelValue:L.value,"onUpdate:modelValue":e[2]||(e[2]=o=>L.value=o),optionLabel:"name"},null,8,["options","modelValue"]),pe]),u(d,{onClick:e[3]||(e[3]=o=>l.toggleGaugeModal(!0)),icon:"pi pi-plus"})])]),t("div",ve,[t("span",_e,[u(c,{type:"text",id:"productId",modelValue:M.value,"onUpdate:modelValue":e[4]||(e[4]=o=>M.value=o)},null,8,["modelValue"]),fe])]),t("div",he,[t("span",ge,[u(r,{id:"date",modelValue:R.value,"onUpdate:modelValue":e[5]||(e[5]=o=>R.value=o)},null,8,["modelValue"]),be])]),ye,xe,Ce,t("div",qe,[t("p",ke,"Total: "+b(f(n.value)?q(i).commaSeparator(f(n.value)-Number(m.value)+Number(C.value)):0),1)]),t("div",Ie,[t("div",Se,[u(Y,{value:n.value,size:"small",rows:20,dataKey:"id",rowHover:!0,filterDisplay:"menu",responsiveLayout:"scroll"},{default:y(()=>[u(p,{field:"name",header:"Name",style:{"max-width":"10rem"}},{body:y(({data:o})=>[o.id?x("",!0):(_(),N(a,{key:0,id:"subCategory",change:"",options:V.value,filter:"",optionLabel:"name",onChange:e[6]||(e[6]=h=>z(h.value))},null,8,["options"])),T(" "+b(o.name),1)]),_:1}),u(p,{field:"price",header:"Price",style:{"max-width":"10rem"}},{body:y(({data:o})=>[T(b(q(i).commaSeparator(o.price)),1)]),_:1}),u(p,{field:"quantity",header:"Qty",style:{"min-width":"10rem"}},{body:y(({data:o})=>[o.id?(_(),S("i",{key:0,class:"pi pi-minus",onClick:h=>E(o,"Subtract"),style:{"font-size":"1rem","margin-left":"3px",cursor:"pointer"}},null,8,Ne)):x("",!0),o.id?(_(),N(c,{key:1,type:"text",onChange:h=>Q(h,o),value:o.quantity,style:{width:"60px",padding:"5px","margin-left":"1px","margin-right":"1px","text-align":"center"},placeholder:"Qty"},null,8,["onChange","value"])):x("",!0),o.id?(_(),S("i",{key:2,class:"pi pi-plus",onClick:h=>E(o,"Add"),style:{"font-size":"1rem","margin-right":"3px",cursor:"pointer"}},null,8,Te)):x("",!0)]),_:1}),u(p,{field:"subtotal",header:"Sub Total",style:{"max-width":"10rem"}},{body:y(({data:o})=>[T(b(o.id?q(i).commaSeparator(o.quantity*o.price):""),1)]),_:1}),u(p,{headerStyle:"max-width:10rem;"},{body:y(({data:o})=>[o.id?(_(),N(d,{key:0,icon:"pi pi-trash",class:"p-button-rounded p-button-danger mr-2",onClick:h=>P(o)},null,8,["onClick"])):x("",!0)]),_:1})]),_:1},8,["value"])])]),Ve,t("div",we,[u(d,{label:"Clear",onClick:W,icon:"pi pi-minus",iconPos:"left",class:"p-button-danger mr-2 mb-2"})]),De,Ue,t("div",Ee,[t("p",Ae,"Total: "+b(f(n.value)?q(i).commaSeparator(f(n.value)-Number(m.value)+Number(C.value)):0),1)]),Be,t("div",Me,[t("span",Le,[u(c,{type:"text",id:"discount",modelValue:v.value,"onUpdate:modelValue":e[7]||(e[7]=o=>v.value=o)},null,8,["modelValue"]),Re])]),t("div",Oe,[v.value&&v.value>0?(_(),S("p",Xe,"Change: "+b(q(i).commaSeparator(Number(v.value)+Number(m.value)-f(n.value))),1)):x("",!0)]),t("div",$e,[u(d,{onClick:G,label:"SUBMIT",class:"p-button-outlined mr-2 mb-2"})])])}}};export{Qe as default};
