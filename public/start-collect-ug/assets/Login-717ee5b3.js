import{D as q,k as L,r as t,u as U,l as j,A as N,b as f,c as $,d as K,e as s,h as r,i as T,n as B,C as z}from"./index-54b662c4.js";const A={class:"surface-ground flex align-items-center justify-content-center min-h-screen min-w-screen overflow-hidden"},H={class:"flex flex-column align-items-center justify-content-center"},G=["src"],J={style:{"border-radius":"56px",padding:"0.3rem",background:"linear-gradient(180deg, var(--primary-color) 10%, rgba(33, 150, 243, 0) 30%)"}},O={class:"w-full surface-card py-8 px-5 sm:px-8",style:{"border-radius":"53px"}},Q={class:"grid p-fluid"},W={class:"field col-12 md:col-12"},X={class:"p-float-label"},Y={class:"field col-12 md:col-12"},Z={class:"p-float-label"},ee={__name:"Login",setup(se){const w=L();t([]);const l=new z;U();const k=j(),b=t(""),g=t("");t(!1);const _=t(!1),i=t({}),d=t(null),u=t(null),x=t(!0),v=t({}),R=N(()=>"demo/images/SmarCollectlogo-removebg-preview.png"),y=a=>{_.value=a},h=()=>{let a={email:b.value,password:g.value};l.genericRequest("user-login","post",!1,a).then(e=>{var m,c;if(e.status){const o={token:e.data.token.accessToken,userData:e.data.user_data};i.value=o,(c=(m=i==null?void 0:i.value)==null?void 0:m.userData)!=null&&c.reset_required?y(!0):D(o)}else l.showError(w,e.message)})},S=(a,e)=>{v.value[e]=l.validateFormField(a)},F=async()=>{var m,c;if(v.value.newPassword=l.validateFormField(d.value),v.value.confirmPassword=l.validateFormField(u.value),l.validateRequiredFields(v.value)||d.value!=u.value){l.showError(w,"Please fill in the missing field");return}let e={userId:(c=(m=i==null?void 0:i.value)==null?void 0:m.userData)==null?void 0:c.id,oldPassword:g.value,newPassword:d.value,confirmPassword:u.value};await l.setStorage(i.value),l.genericRequest("reset-password","post",!0,e).then(o=>{o.status?(l.showSuccess(w,o.message),y(!1),d.value=null,u.value=null):l.showError(w,o.message)}),await l.removeStorage()},V=()=>{d.value===u.value?x.value=!0:x.value=!1},D=async a=>{await l.setStorage(a),await E()},E=()=>{k.push("/admin")},I=()=>{k.push("/auth/register")};return(a,e)=>{const m=f("Toast"),c=f("InputText"),o=f("Password"),P=f("Button"),M=f("Dialog");return $(),K("div",A,[s("div",H,[s("img",{src:R.value,alt:"Sakai logo",class:"mb-5 w-30rem flex-shrink-0"},null,8,G),s("div",J,[s("div",O,[r(m),e[11]||(e[11]=s("div",{class:"text-center mb-5"},[s("div",{class:"text-900 text-3xl font-medium mb-3"}),s("span",{class:"text-600 font-medium"},"Sign in to continue")],-1)),s("div",null,[e[9]||(e[9]=s("label",{for:"email1",class:"block text-900 text-xl font-medium mb-2"},"Email",-1)),r(c,{id:"email1",type:"text",placeholder:"Email address",class:"w-full md:w-30rem mb-5",style:{padding:"1rem"},modelValue:b.value,"onUpdate:modelValue":e[0]||(e[0]=n=>b.value=n)},null,8,["modelValue"]),e[10]||(e[10]=s("label",{for:"password1",class:"block text-900 font-medium text-xl mb-2"},"Password",-1)),r(o,{id:"password1",modelValue:g.value,"onUpdate:modelValue":e[1]||(e[1]=n=>g.value=n),placeholder:"Password",feedback:!1,toggleMask:!0,class:"w-full mb-3",inputClass:"w-full",inputStyle:"padding:1rem"},null,8,["modelValue"]),s("div",{class:"flex align-items-center justify-content-between mb-5 gap-5"},[s("div",{class:"flex align-items-center"},[s("a",{class:"font-medium no-underline ml-2 text-left cursor-pointer",style:{color:"var(--primary-color)"},onClick:I},"Self enroll")]),e[8]||(e[8]=s("a",{class:"font-medium no-underline ml-2 text-right cursor-pointer",style:{color:"var(--primary-color)"}},"Forgot password?",-1))]),r(P,{onClick:h,label:"Sign In",class:"w-full p-3 text-xl"})])])])]),r(M,{header:"Reset Password",visible:_.value,"onUpdate:visible":e[7]||(e[7]=n=>_.value=n),style:{width:"40vw"},modal:!0,class:"p-fluid"},{footer:T(()=>[r(P,{label:"Cancel",onClick:e[6]||(e[6]=n=>y(!1)),icon:"pi pi-times",class:"p-button-outlined p-button-danger mr-2 mb-2"}),r(P,{onClick:F,label:"SUBMIT",class:"p-button-outlined mr-2 mb-2"})]),default:T(()=>{var n,C;return[s("div",Q,[s("div",W,[s("span",X,[r(o,{type:"text",id:"password",onKeyup:V,modelValue:d.value,"onUpdate:modelValue":e[2]||(e[2]=p=>d.value=p),onBlur:e[3]||(e[3]=p=>S(d.value,"newPassword")),class:B({"p-invalid":((n=v.value)==null?void 0:n.newPassword)||!x.value}),toggleMask:!0},null,8,["modelValue","class"]),e[12]||(e[12]=s("label",{for:"password"},"New Password",-1))])]),s("div",Y,[s("span",Z,[r(o,{type:"text",id:"confirmPassword",onKeyup:V,modelValue:u.value,"onUpdate:modelValue":e[4]||(e[4]=p=>u.value=p),onBlur:e[5]||(e[5]=p=>S(u.value,"confirmPassword")),class:B({"p-invalid":((C=v.value)==null?void 0:C.confirmPassword)||!x.value}),toggleMask:!0},null,8,["modelValue","class"]),e[13]||(e[13]=s("label",{for:"confirmPassword"},"Confirm Password",-1))])])])]}),_:1},8,["visible"])])}}},oe=q(ee,[["__scopeId","data-v-a1c570fe"]]);export{oe as default};
