import{i as O,j as P,r as h,s as R,o as E,b,c as w,d as C,f as e,h as a,k as i,t as u,e as v,g as N,v as Q,l as _,C as U}from"./index-b8fa6139.js";const $={class:"grid p-fluid"},j={class:"col-12 md:col-7"},z={class:"card"},L=e("h5",null,"Point Of Sale",-1),F=e("br",null,null,-1),H={class:"grid"},K={class:"col-12 md:col-12"},G=e("p",null,"Items available in the stock.",-1),J={class:"flex flex-column md:flex-row md:justify-content-between md:align-items-center"},W={class:"block mt-2 md:mt-0 p-input-icon-left"},X=e("i",{class:"pi pi-search"},null,-1),Y={class:"col-12 md:col-5"},Z={class:"card"},ee=e("h5",null,"Selected Items",-1),te=e("br",null,null,-1),le={class:"grid"},se={class:"field col-12 md:col-12"},oe=["onClick"],ae=["onClick"],ne={class:"card"},ie=e("h5",null,"Total ",-1),ce=e("br",null,null,-1),de={class:"grid"},ue=e("div",{class:"field col-12 md:col-4"},[e("span",{class:"p-float-label"}," Amount To Pay ")],-1),re={class:"field col-12 md:col-8"},me={class:"p-float-label"},_e=e("div",{class:"field col-12 md:col-4"},[e("span",{class:"p-float-label"}," Discount ")],-1),he={class:"field col-12 md:col-8"},pe={class:"p-float-label"},ve=e("label",{for:"discount"},"Discount Amount",-1),fe=e("div",{class:"field col-12 md:col-4"},[e("span",{class:"p-float-label"}," Amount Paid ")],-1),ye={class:"field col-12 md:col-8"},be={class:"p-float-label"},ge=e("label",{for:"discount"},"Amount",-1),xe=e("div",{class:"field col-12 md:col-4"},[e("span",{class:"p-float-label"}," Change ")],-1),we={class:"field col-12 md:col-8"},Ce={key:0,class:"p-float-label"},Se={key:1,class:"p-float-label"},ke=e("div",{class:"field col-12 md:col-8"},null,-1),qe={class:"field col-12 md:col-4"},De={__name:"PointOfSale",setup(Ne){const g=O(),d=new U,V=P(),S=h(null),o=h([]),r=h(0),m=h(0);h(0);const f=h({}),D=()=>{d.genericRequest("get-products","get",!0,{}).then(n=>{n.status?S.value=n.data:d.showError(g,n.message)})},I=n=>{let l={id:n.id,price:n.selling_price,quantity:1,discount:0,name:n.name};const s=o.value.find(c=>c.id===l.id);s?s.quantity+=l.quantity:o.value.push(l)},T=n=>{const l=o.value.findIndex(s=>s.id===n.id);l!==-1&&o.value.splice(l,1)},A=(n,l)=>{o.value=o.value.map(s=>s.id===l.id?{...s,quantity:Number(n.target.value)}:s)},k=(n,l)=>{o.value=o.value.map(s=>{if(s.id===n.id){if(l=="Add")return{...s,quantity:Number(s.quantity+1)};if(s.quantity>0)return{...s,quantity:Number(s.quantity-1)}}return s})},y=n=>{let l=0;return n.length>0&&n.forEach(s=>{l+=s.quantity*s.price}),l},B=()=>{let n={total:y(o==null?void 0:o.value)-Number(m==null?void 0:m.value),discount:Number(m==null?void 0:m.value),amountPaid:Number(r==null?void 0:r.value),itemCount:o==null?void 0:o.value.length,tranDate:new Date,items:o==null?void 0:o.value,status:"Active"};d.genericRequest("create-order","post",!0,n).then(l=>{l.status?(d.showSuccess(g,l.message),d.redirect(V,"/view-sales")):d.showError(g,l.message)})},M=()=>{f.value={global:{value:null,matchMode:Q.CONTAINS}}};return R(()=>{M()}),E(()=>{D()}),(n,l)=>{const s=b("InputText"),c=b("Column"),x=b("Button"),q=b("DataTable");return w(),C("div",$,[e("div",j,[e("div",z,[L,F,e("div",H,[e("div",K,[G,a(q,{value:S.value,paginator:!0,class:"p-datatable-gridlines",rows:50,dataKey:"id",filters:f.value,rowHover:!0,filterDisplay:"menu",responsiveLayout:"scroll"},{header:i(()=>[e("div",J,[e("span",W,[X,a(s,{modelValue:f.value.global.value,"onUpdate:modelValue":l[0]||(l[0]=t=>f.value.global.value=t),placeholder:"Search..."},null,8,["modelValue"])])])]),default:i(()=>[a(c,{field:"name",header:"Product",style:{"min-width":"10rem"}},{body:i(({data:t})=>[_(u(t.name),1)]),_:1}),a(c,{field:"name",header:"Category",style:{"min-width":"10rem"}},{body:i(({data:t})=>[_(u(t.category_name),1)]),_:1}),a(c,{field:"name",header:"Price",style:{"max-width":"10rem"}},{body:i(({data:t})=>[_(u(v(d).commaSeparator(t.selling_price)),1)]),_:1}),a(c,{field:"name",header:"Quantity",style:{"max-width":"15rem"}},{body:i(({data:t})=>[_(u(t.quantity+" "+t.unit),1)]),_:1}),a(c,{header:"Manufacturer",style:{"min-width":"10rem"}},{body:i(({data:t})=>[_(u(t.manufacturer),1)]),_:1}),a(c,{header:"Date",style:{"min-width":"10rem"}},{body:i(({data:t})=>[_(u(t.created_at),1)]),_:1}),a(c,{headerStyle:"max-width:10rem;"},{body:i(({data:t})=>[a(x,{icon:"pi pi-check",class:"p-button-rounded p-button-success mr-2",onClick:p=>I(t)},null,8,["onClick"])]),_:1})]),_:1},8,["value","filters"])])])])]),e("div",Y,[e("div",Z,[ee,te,e("div",le,[e("div",se,[a(q,{value:o.value,size:"small",rows:20,dataKey:"id",rowHover:!0,filterDisplay:"menu",responsiveLayout:"scroll"},{default:i(()=>[a(c,{field:"name",header:"Name",style:{"max-width":"10rem"}},{body:i(({data:t})=>[_(u(t.name),1)]),_:1}),a(c,{field:"price",header:"Price",style:{"max-width":"10rem"}},{body:i(({data:t})=>[_(u(v(d).commaSeparator(t.price)),1)]),_:1}),a(c,{field:"quantity",header:"Qty",style:{"min-width":"10rem"}},{body:i(({data:t})=>[e("i",{class:"pi pi-plus",onClick:p=>k(t,"Add"),style:{"font-size":"1rem","margin-right":"3px",cursor:"pointer"}},null,8,oe),a(s,{type:"text",onChange:p=>A(p,t),value:t.quantity,style:{width:"60px",padding:"5px","margin-left":"1px","margin-right":"1px","text-align":"center"},placeholder:"Qty"},null,8,["onChange","value"]),e("i",{class:"pi pi-minus",onClick:p=>k(t,"Subtract"),style:{"font-size":"1rem","margin-left":"3px",cursor:"pointer"}},null,8,ae)]),_:1}),a(c,{field:"subtotal",header:"Sub Total",style:{"max-width":"10rem"}},{body:i(({data:t})=>[_(u(v(d).commaSeparator(t.quantity*t.price)),1)]),_:1}),a(c,{headerStyle:"max-width:10rem;"},{body:i(({data:t})=>[a(x,{icon:"pi pi-trash",class:"p-button-rounded p-button-danger mr-2",onClick:p=>T(t)},null,8,["onClick"])]),_:1})]),_:1},8,["value"])])])]),e("div",ne,[ie,ce,e("div",de,[ue,e("div",re,[e("span",me,u(y(o.value)?v(d).commaSeparator(y(o.value)-Number(m.value)):0),1)]),_e,e("div",he,[e("span",pe,[a(s,{type:"text",id:"discount",modelValue:m.value,"onUpdate:modelValue":l[1]||(l[1]=t=>m.value=t)},null,8,["modelValue"]),ve])]),fe,e("div",ye,[e("span",be,[a(s,{type:"text",id:"discount",modelValue:r.value,"onUpdate:modelValue":l[2]||(l[2]=t=>r.value=t)},null,8,["modelValue"]),ge])]),xe,e("div",we,[r.value&&r.value>0?(w(),C("span",Ce,u(v(d).commaSeparator(Number(r.value)+Number(m.value)-y(o.value))),1)):N("",!0),!r.value||r.value==0?(w(),C("span",Se,"0")):N("",!0)]),ke,e("div",qe,[a(x,{onClick:B,label:"SUBMIT",class:"p-button-outlined mr-2 mb-2"})])])])])])}}};export{De as default};
